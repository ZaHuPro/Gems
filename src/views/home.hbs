<div class="form-group">
  <label for="fName">fName {{address}}</label>
  <input type="text" class="form-control" id="fName" aria-describedby="emailHelp">
</div>
<div class="form-group">
  <label for="age">age</label>
  <input type="number" class="form-control" id="age">
</div>
<button type="button" id="set" class="btn btn-primary">Submit</button>

<div id='instructor'>

</div>


<script>
  var LotteryJSON;
  var Lottery;
  $.getJSON('/contracts/LuckyDraw.json', function (data) {
    LotteryJSON = data

    if (typeof web3 !== 'undefined') {
      web3 = new Web3(web3.currentProvider)
    } else {
      web3 = new Web3(new Web3.providers.HttpProviders('http://localhost:7545'))
    }
    web3.eth.defaultAccount = web3.eth.accounts[0];
    var receiverAddress = web3.eth.defaultAccount;
    console.log(web3.eth.defaultAccount)

    var LotteryContract = web3.eth.contract(LotteryJSON.abi)
    Lottery = LotteryContract.at(LotteryJSON.networks['5777'].address)



    Lottery.productCount(function (err, res) {
      var countIs = web3.fromWei(res.toNumber(), "ether")
      console.log("instructorinstructor = ", countIs)
      $("#instructor").html(countIs)
    });





    $('#set').click(function () {

      //console.log(Lottery)

      var setData = Lottery.createProduct.getData("Test", 10, 5);

      console.log(setData);
      web3.eth.estimateGas({
        from: receiverAddress,
        to: LotteryJSON.networks['5777'].address,
        data: setData
      }, function (err, gasEstimate) {
        if (!err)

          web3.eth.getGasPrice(function (error, gasPrice) {

            console.log('gas Price: ' + gasPrice);
            console.log('Estimated Transaction gas: ' + gasEstimate, Lottery);

            web3.eth.sendTransaction({
              from: receiverAddress,
              to: LotteryJSON.networks['5777'].address,
              data: setData,
              gasPrice: gasPrice,
              gas: gasEstimate
            }, function (err, data) {
              console.log(err, data)
            })

            /*Lottery.createProduct("Test", 10, 5).send({
              from: receiverAddress,
              to: LotteryJSON.networks['5777'].address,
              gasPrice: gasPrice,
              gas: gasEstimate
            }, function (error, createProductData) {
              console.log(createProductData)
            }) */



          })

      })


    });

  });

</script>